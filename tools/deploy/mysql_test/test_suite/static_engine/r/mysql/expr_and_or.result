result_format: 4

set ob_enable_plan_cache = 0;
drop table if exists t1;
create table t1(col_int int, 
                col_zero int,
                col_null int, 
                col_varchar varchar(100), 
                col_varchar_num varchar(100),
                col_empty_str varchar(100),
                col_varchar_zero varchar(100));
insert into t1 values(1, 0, null, 'abc', '1', '', '0');

explain_protocol: 2
// Case1: normal test
// Case1.1: int test
//  bool expr exists, no cast expr, res is NULL
EXPLAIN select col_int and col_null from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([t1.col_int AND t1.col_null]), filter(nil), 
      access([t1.col_int], [t1.col_null]), partitions(p0)

select col_int and col_null from t1;
+----------------------+
| col_int and col_null |
+----------------------+
|                 NULL |
+----------------------+
// same as above
EXPLAIN select col_null and col_int from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([t1.col_null AND t1.col_int]), filter(nil), 
      access([t1.col_null], [t1.col_int]), partitions(p0)

select col_null and col_int from t1;
+----------------------+
| col_null and col_int |
+----------------------+
|                 NULL |
+----------------------+

// bool expr exists for col_varchar, cast expr exists, res is 0
EXPLAIN select col_int and col_varchar from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([t1.col_int AND cast(t1.col_varchar, DOUBLE(-1, -1))]), filter(nil), 
      access([t1.col_int], [t1.col_varchar]), partitions(p0)

select col_int and col_varchar from t1;
+-------------------------+
| col_int and col_varchar |
+-------------------------+
|                       0 |
+-------------------------+
Warnings:
Warning	1292	Truncated incorrect DOUBLE value: 'abc'
// same as above
EXPLAIN select col_varchar and col_int from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([cast(t1.col_varchar, DOUBLE(-1, -1)) AND t1.col_int]), filter(nil), 
      access([t1.col_varchar], [t1.col_int]), partitions(p0)

select col_varchar and col_int from t1;
+-------------------------+
| col_varchar and col_int |
+-------------------------+
|                       0 |
+-------------------------+
Warnings:
Warning	1292	Truncated incorrect DOUBLE value: 'abc'

// bool expr and cast expr exists for col_varchar_num, res is 0
EXPLAIN select col_int and col_varchar_num from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([t1.col_int AND cast(t1.col_varchar_num, DOUBLE(-1, -1))]), filter(nil), 
      access([t1.col_int], [t1.col_varchar_num]), partitions(p0)

select col_int and col_varchar_num from t1;
+-----------------------------+
| col_int and col_varchar_num |
+-----------------------------+
|                           1 |
+-----------------------------+
// same as above
EXPLAIN select col_varchar_num and col_int from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([cast(t1.col_varchar_num, DOUBLE(-1, -1)) AND t1.col_int]), filter(nil), 
      access([t1.col_varchar_num], [t1.col_int]), partitions(p0)

select col_varchar_num and col_int from t1;
+-----------------------------+
| col_varchar_num and col_int |
+-----------------------------+
|                           1 |
+-----------------------------+

// bool expr exists, no cast expr, res is 0
EXPLAIN select col_int and 0 from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([t1.col_int AND 0]), filter(nil), 
      access([t1.col_int]), partitions(p0)

select col_int and 0 from t1;
+---------------+
| col_int and 0 |
+---------------+
|             0 |
+---------------+
// same as above
EXPLAIN select 0 and col_int from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([0 AND t1.col_int]), filter(nil), 
      access([t1.col_int]), partitions(p0)

select 0 and col_int from t1;
+---------------+
| 0 and col_int |
+---------------+
|             0 |
+---------------+

// Case1.1: null test
// bool expr exists, no cast expr, res is NULL
EXPLAIN select col_null and col_null from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([t1.col_null AND t1.col_null]), filter(nil), 
      access([t1.col_null]), partitions(p0)

select col_null and col_null from t1;
+-----------------------+
| col_null and col_null |
+-----------------------+
|                  NULL |
+-----------------------+
// bool expr and cast expr exists for col_varchar_num, res is NULL
EXPLAIN select col_null and col_varchar_num from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([t1.col_null AND cast(t1.col_varchar_num, DOUBLE(-1, -1))]), filter(nil), 
      access([t1.col_null], [t1.col_varchar_num]), partitions(p0)

select col_null and col_varchar_num from t1;
+------------------------------+
| col_null and col_varchar_num |
+------------------------------+
|                         NULL |
+------------------------------+
// same as above
EXPLAIN select col_varchar_num and col_null from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([cast(t1.col_varchar_num, DOUBLE(-1, -1)) AND t1.col_null]), filter(nil), 
      access([t1.col_varchar_num], [t1.col_null]), partitions(p0)

select col_varchar_num and col_null from t1;
+------------------------------+
| col_varchar_num and col_null |
+------------------------------+
|                         NULL |
+------------------------------+

// bool expr and cast expr exists for col_varchar_num, res is 0
EXPLAIN select col_null and col_varchar from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([t1.col_null AND cast(t1.col_varchar, DOUBLE(-1, -1))]), filter(nil), 
      access([t1.col_null], [t1.col_varchar]), partitions(p0)

select col_null and col_varchar from t1;
+--------------------------+
| col_null and col_varchar |
+--------------------------+
|                        0 |
+--------------------------+
Warnings:
Warning	1292	Truncated incorrect DOUBLE value: 'abc'
// same as above
EXPLAIN select col_varchar and col_null from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([cast(t1.col_varchar, DOUBLE(-1, -1)) AND t1.col_null]), filter(nil), 
      access([t1.col_varchar], [t1.col_null]), partitions(p0)

select col_varchar and col_null from t1;
+--------------------------+
| col_varchar and col_null |
+--------------------------+
|                        0 |
+--------------------------+
Warnings:
Warning	1292	Truncated incorrect DOUBLE value: 'abc'

// same as above
EXPLAIN select col_null and 0 from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([t1.col_null AND 0]), filter(nil), 
      access([t1.col_null]), partitions(p0)

select col_null and 0 from t1;
+----------------+
| col_null and 0 |
+----------------+
|              0 |
+----------------+

// Case1.2: 0 test
// bool expr exists, no cast expr, res is 0
EXPLAIN select col_varchar_num and 0 from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([cast(t1.col_varchar_num, DOUBLE(-1, -1)) AND 0]), filter(nil), 
      access([t1.col_varchar_num]), partitions(p0)

select col_varchar_num and 0 from t1;
+-----------------------+
| col_varchar_num and 0 |
+-----------------------+
|                     0 |
+-----------------------+
// same as above
EXPLAIN select col_varchar_num and 0 from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([cast(t1.col_varchar_num, DOUBLE(-1, -1)) AND 0]), filter(nil), 
      access([t1.col_varchar_num]), partitions(p0)

select col_varchar_num and 0 from t1;
+-----------------------+
| col_varchar_num and 0 |
+-----------------------+
|                     0 |
+-----------------------+

// Case1.3: empty str test
// bool expr and cast expr exists for empty str, res is 0
EXPLAIN select col_int and '' from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([t1.col_int AND ?]), filter(nil), 
      access([t1.col_int]), partitions(p0)

select col_int and '' from t1;
+----------------+
| col_int and '' |
+----------------+
|              0 |
+----------------+
// same as above
EXPLAIN select '' and col_int from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([? AND t1.col_int]), filter(nil), 
      access([t1.col_int]), partitions(p0)

select '' and col_int from t1;
+----------------+
| '' and col_int |
+----------------+
|              0 |
+----------------+

// bool expr and cast expr exists for empty str and col_varchar, res is 0
EXPLAIN select col_varchar and '' from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([cast(t1.col_varchar, DOUBLE(-1, -1)) AND ?]), filter(nil), 
      access([t1.col_varchar]), partitions(p0)

select col_varchar and '' from t1;
+--------------------+
| col_varchar and '' |
+--------------------+
|                  0 |
+--------------------+
Warnings:
Warning	1292	Truncated incorrect DOUBLE value: 'abc'
// same as above
EXPLAIN select '' and col_varchar from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([? AND cast(t1.col_varchar, DOUBLE(-1, -1))]), filter(nil), 
      access([t1.col_varchar]), partitions(p0)

select '' and col_varchar from t1;
+--------------------+
| '' and col_varchar |
+--------------------+
|                  0 |
+--------------------+
// bool expr and cast expr exists for empty str and col_varchar_num, res is 0
EXPLAIN select col_varchar_num and '' from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([cast(t1.col_varchar_num, DOUBLE(-1, -1)) AND ?]), filter(nil), 
      access([t1.col_varchar_num]), partitions(p0)

select col_varchar_num and '' from t1;
+------------------------+
| col_varchar_num and '' |
+------------------------+
|                      0 |
+------------------------+

// same as above
EXPLAIN select '' and col_varchar_num from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([? AND cast(t1.col_varchar_num, DOUBLE(-1, -1))]), filter(nil), 
      access([t1.col_varchar_num]), partitions(p0)

select '' and col_varchar_num from t1;
+------------------------+
| '' and col_varchar_num |
+------------------------+
|                      0 |
+------------------------+

// Case2: create table as test. 因为select/explain语句对应的cast mode
// 有WARN_ON_FAIL。其他的没有，所以结果是有区别的
// TODO: 目前没法测试，建表语句还不完善
// Case3: or test
// Case3.1 normal test
// bool expr exists, res is 1
EXPLAIN select col_int or col_int from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([t1.col_int OR t1.col_int]), filter(nil), 
      access([t1.col_int]), partitions(p0)

select col_int or col_int from t1;
+--------------------+
| col_int or col_int |
+--------------------+
|                  1 |
+--------------------+
// bool expr exists, res is 0
EXPLAIN select col_zero or col_zero from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([t1.col_zero OR t1.col_zero]), filter(nil), 
      access([t1.col_zero]), partitions(p0)

select col_zero or col_zero from t1;
+----------------------+
| col_zero or col_zero |
+----------------------+
|                    0 |
+----------------------+
// bool expr exists, cast expr exists res is 0
EXPLAIN select col_varchar_zero or col_varchar_zero from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([cast(t1.col_varchar_zero, DOUBLE(-1, -1)) OR cast(t1.col_varchar_zero, DOUBLE(-1, -1))]), filter(nil), 
      access([t1.col_varchar_zero]), partitions(p0)

select col_varchar_zero or col_varchar_zero from t1;
+--------------------------------------+
| col_varchar_zero or col_varchar_zero |
+--------------------------------------+
|                                    0 |
+--------------------------------------+

// Case3.2 null test
// bool expr exists, res is NULL
EXPLAIN select col_null or col_null from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([t1.col_null OR t1.col_null]), filter(nil), 
      access([t1.col_null]), partitions(p0)

select col_null or col_null from t1;
+----------------------+
| col_null or col_null |
+----------------------+
|                 NULL |
+----------------------+
// bool expr exists, res is 1
EXPLAIN select col_int or col_null from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([t1.col_int OR t1.col_null]), filter(nil), 
      access([t1.col_int], [t1.col_null]), partitions(p0)

select col_int or col_null from t1;
+---------------------+
| col_int or col_null |
+---------------------+
|                   1 |
+---------------------+
// same as above
EXPLAIN select col_null or col_int from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([t1.col_null OR t1.col_int]), filter(nil), 
      access([t1.col_null], [t1.col_int]), partitions(p0)

select col_null or col_int from t1;
+---------------------+
| col_null or col_int |
+---------------------+
|                   1 |
+---------------------+

// bool expr exists, res is NULL
EXPLAIN select col_zero or col_null from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([t1.col_zero OR t1.col_null]), filter(nil), 
      access([t1.col_zero], [t1.col_null]), partitions(p0)

select col_zero or col_null from t1;
+----------------------+
| col_zero or col_null |
+----------------------+
|                 NULL |
+----------------------+
// same as above
EXPLAIN select col_null or col_zero from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([t1.col_null OR t1.col_zero]), filter(nil), 
      access([t1.col_null], [t1.col_zero]), partitions(p0)

select col_null or col_zero from t1;
+----------------------+
| col_null or col_zero |
+----------------------+
|                 NULL |
+----------------------+

// bool expr exists, res is 1
EXPLAIN select col_varchar_num or col_null from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([cast(t1.col_varchar_num, DOUBLE(-1, -1)) OR t1.col_null]), filter(nil), 
      access([t1.col_varchar_num], [t1.col_null]), partitions(p0)

select col_varchar_num or col_null from t1;
+-----------------------------+
| col_varchar_num or col_null |
+-----------------------------+
|                           1 |
+-----------------------------+
// same as above
EXPLAIN select col_null or col_varchar_num from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([t1.col_null OR cast(t1.col_varchar_num, DOUBLE(-1, -1))]), filter(nil), 
      access([t1.col_null], [t1.col_varchar_num]), partitions(p0)

select col_null or col_varchar_num from t1;
+-----------------------------+
| col_null or col_varchar_num |
+-----------------------------+
|                           1 |
+-----------------------------+

// bool expr exists, res is NULL
EXPLAIN select col_varchar_zero or col_null from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([cast(t1.col_varchar_zero, DOUBLE(-1, -1)) OR t1.col_null]), filter(nil), 
      access([t1.col_varchar_zero], [t1.col_null]), partitions(p0)

select col_varchar_zero or col_null from t1;
+------------------------------+
| col_varchar_zero or col_null |
+------------------------------+
|                         NULL |
+------------------------------+
// same as above
EXPLAIN select col_null or col_varchar_zero from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([t1.col_null OR cast(t1.col_varchar_zero, DOUBLE(-1, -1))]), filter(nil), 
      access([t1.col_null], [t1.col_varchar_zero]), partitions(p0)

select col_null or col_varchar_zero from t1;
+------------------------------+
| col_null or col_varchar_zero |
+------------------------------+
|                         NULL |
+------------------------------+

// Case3.3 empty str test
// bool expr exists, res is NULL
EXPLAIN select col_null or '' from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([t1.col_null OR ?]), filter(nil), 
      access([t1.col_null]), partitions(p0)

select col_null or '' from t1;
+----------------+
| col_null or '' |
+----------------+
|           NULL |
+----------------+
// same as above
EXPLAIN select '' or col_null from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([? OR t1.col_null]), filter(nil), 
      access([t1.col_null]), partitions(p0)

select '' or col_null from t1;
+----------------+
| '' or col_null |
+----------------+
|           NULL |
+----------------+

// bool expr exists, res is 1
EXPLAIN select col_int or '' from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([t1.col_int OR ?]), filter(nil), 
      access([t1.col_int]), partitions(p0)

select col_int or '' from t1;
+---------------+
| col_int or '' |
+---------------+
|             1 |
+---------------+
// same as above
EXPLAIN select '' or col_int from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([? OR t1.col_int]), filter(nil), 
      access([t1.col_int]), partitions(p0)

select '' or col_int from t1;
+---------------+
| '' or col_int |
+---------------+
|             1 |
+---------------+

// bool expr exists, res is 0
EXPLAIN select col_zero or '' from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([t1.col_zero OR ?]), filter(nil), 
      access([t1.col_zero]), partitions(p0)

select col_zero or '' from t1;
+----------------+
| col_zero or '' |
+----------------+
|              0 |
+----------------+
// same as above
EXPLAIN select '' or col_zero from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([? OR t1.col_zero]), filter(nil), 
      access([t1.col_zero]), partitions(p0)

select '' or col_zero from t1;
+----------------+
| '' or col_zero |
+----------------+
|              0 |
+----------------+

// res is 0
EXPLAIN select col_empty_str or '' from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([cast(t1.col_empty_str, DOUBLE(-1, -1)) OR ?]), filter(nil), 
      access([t1.col_empty_str]), partitions(p0)

select col_empty_str or '' from t1;
+---------------------+
| col_empty_str or '' |
+---------------------+
|                   0 |
+---------------------+

// Case4: multi and test
// res is 1
EXPLAIN select 1 and 2 and 3 and col_int from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([? AND t1.col_int]), filter(nil), 
      access([t1.col_int]), partitions(p0)

select 1 and 2 and 3 and col_int from t1;
+---------------------------+
| 1 and 2 and 3 and col_int |
+---------------------------+
|                         1 |
+---------------------------+
// res is NULL
EXPLAIN select 1 and col_null and 3 and col_int from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([1 AND t1.col_null AND 3 AND t1.col_int]), filter(nil), 
      access([t1.col_null], [t1.col_int]), partitions(p0)

select 1 and col_null and 3 and col_int from t1;
+----------------------------------+
| 1 and col_null and 3 and col_int |
+----------------------------------+
|                             NULL |
+----------------------------------+
// res is 0
EXPLAIN select 1 and col_null and 3 and col_zero from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([1 AND t1.col_null AND 3 AND t1.col_zero]), filter(nil), 
      access([t1.col_null], [t1.col_zero]), partitions(p0)

select 1 and col_null and 3 and col_zero from t1;
+-----------------------------------+
| 1 and col_null and 3 and col_zero |
+-----------------------------------+
|                                 0 |
+-----------------------------------+
// res is 0
EXPLAIN select 1 and col_null and 3 and col_empty_str from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([1 AND t1.col_null AND 3 AND cast(t1.col_empty_str, DOUBLE(-1, -1))]), filter(nil), 
      access([t1.col_null], [t1.col_empty_str]), partitions(p0)

select 1 and col_null and 3 and col_empty_str from t1;
+----------------------------------------+
| 1 and col_null and 3 and col_empty_str |
+----------------------------------------+
|                                      0 |
+----------------------------------------+

// Case5: multi or test
// res is 1
EXPLAIN select 1 or 2 or col_int from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([? OR t1.col_int]), filter(nil), 
      access([t1.col_int]), partitions(p0)

select 1 or 2 or col_int from t1;
+-------------------+
| 1 or 2 or col_int |
+-------------------+
|                 1 |
+-------------------+
// res is NULL
EXPLAIN select 1 or 2 or col_null from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([? OR t1.col_null]), filter(nil), 
      access([t1.col_null]), partitions(p0)

select 1 or 2 or col_null from t1;
+--------------------+
| 1 or 2 or col_null |
+--------------------+
|                  1 |
+--------------------+
// res is 0
EXPLAIN select '' or 0 or col_null from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([? OR t1.col_null]), filter(nil), 
      access([t1.col_null]), partitions(p0)

select '' or 0 or col_null from t1;
+---------------------+
| '' or 0 or col_null |
+---------------------+
|                NULL |
+---------------------+

// Case6: 0, 1, null三个值组合测试，结果跟不开新引擎的结果进行对比
drop table if exists t1;
explain_protocol: 0
create table t1 (c1 int, c2 int, c3 int, 
                 c4 float, c5 float, c6 float,
                 c7 double, c8 double, c9 double,
                 c10 decimal, c11 decimal, c12 decimal,
                 c13 datetime, c14 datetime, c15 datetime,
                 c16 timestamp, c17 timestamp, c18 timestamp,
                 c19 date, c20 date, c21 date,
                 c22 varchar(10), c23 varchar(10), c24 varchar(10),
                 c25 char(11), c26 char(11), c27 char(12),
                 c28 char(10), c29 char(10), c30 char(10));
insert into t1 values(0, 1, null,
                      0.0, 1.0, null,
                      0.0, 1.0, null,
                      0.0, 1.0, null,
                      0, '2019-01-01 00:00:00', null,
                      0, '2019-01-01 00:00:00', null,
                      0, '2019-01-01', null,
                      '0', '123', null,
                      '0', '123', null,
                      '0', 'abc', null);

explain_protocol: 2
set @@ob_enable_plan_cache = 0;

EXPLAIN select c1, c1, c1 and c1 from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([t1.c1], [t1.c1], [t1.c1 AND t1.c1]), filter(nil), 
      access([t1.c1]), partitions(p0)

select c1, c1, c1 and c1 from t1;
+------+------+-----------+
| c1   | c1   | c1 and c1 |
+------+------+-----------+
|    0 |    0 |         0 |
+------+------+-----------+
EXPLAIN select c1, c1, c1 or c1 from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([t1.c1], [t1.c1], [t1.c1 OR t1.c1]), filter(nil), 
      access([t1.c1]), partitions(p0)

select c1, c1, c1 or c1 from t1;
+------+------+----------+
| c1   | c1   | c1 or c1 |
+------+------+----------+
|    0 |    0 |        0 |
+------+------+----------+
EXPLAIN select c1, c2, c1 and c2 from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([t1.c1], [t1.c2], [t1.c1 AND t1.c2]), filter(nil), 
      access([t1.c1], [t1.c2]), partitions(p0)

select c1, c2, c1 and c2 from t1;
+------+------+-----------+
| c1   | c2   | c1 and c2 |
+------+------+-----------+
|    0 |    1 |         0 |
+------+------+-----------+
EXPLAIN select c1, c2, c1 or c2 from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([t1.c1], [t1.c2], [t1.c1 OR t1.c2]), filter(nil), 
      access([t1.c1], [t1.c2]), partitions(p0)

select c1, c2, c1 or c2 from t1;
+------+------+----------+
| c1   | c2   | c1 or c2 |
+------+------+----------+
|    0 |    1 |        1 |
+------+------+----------+
EXPLAIN select c1, c3, c1 and c3 from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([t1.c1], [t1.c3], [t1.c1 AND t1.c3]), filter(nil), 
      access([t1.c1], [t1.c3]), partitions(p0)

select c1, c3, c1 and c3 from t1;
+------+------+-----------+
| c1   | c3   | c1 and c3 |
+------+------+-----------+
|    0 | NULL |         0 |
+------+------+-----------+
EXPLAIN select c1, c3, c1 or c3 from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([t1.c1], [t1.c3], [t1.c1 OR t1.c3]), filter(nil), 
      access([t1.c1], [t1.c3]), partitions(p0)

select c1, c3, c1 or c3 from t1;
+------+------+----------+
| c1   | c3   | c1 or c3 |
+------+------+----------+
|    0 | NULL |     NULL |
+------+------+----------+
EXPLAIN select c2, c1, c2 and c1 from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([t1.c2], [t1.c1], [t1.c2 AND t1.c1]), filter(nil), 
      access([t1.c2], [t1.c1]), partitions(p0)

select c2, c1, c2 and c1 from t1;
+------+------+-----------+
| c2   | c1   | c2 and c1 |
+------+------+-----------+
|    1 |    0 |         0 |
+------+------+-----------+
EXPLAIN select c2, c1, c2 or c1 from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([t1.c2], [t1.c1], [t1.c2 OR t1.c1]), filter(nil), 
      access([t1.c2], [t1.c1]), partitions(p0)

select c2, c1, c2 or c1 from t1;
+------+------+----------+
| c2   | c1   | c2 or c1 |
+------+------+----------+
|    1 |    0 |        1 |
+------+------+----------+
EXPLAIN select c2, c2, c2 and c2 from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([t1.c2], [t1.c2], [t1.c2 AND t1.c2]), filter(nil), 
      access([t1.c2]), partitions(p0)

select c2, c2, c2 and c2 from t1;
+------+------+-----------+
| c2   | c2   | c2 and c2 |
+------+------+-----------+
|    1 |    1 |         1 |
+------+------+-----------+
EXPLAIN select c2, c2, c2 or c2 from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([t1.c2], [t1.c2], [t1.c2 OR t1.c2]), filter(nil), 
      access([t1.c2]), partitions(p0)

select c2, c2, c2 or c2 from t1;
+------+------+----------+
| c2   | c2   | c2 or c2 |
+------+------+----------+
|    1 |    1 |        1 |
+------+------+----------+
EXPLAIN select c2, c3, c2 and c3 from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([t1.c2], [t1.c3], [t1.c2 AND t1.c3]), filter(nil), 
      access([t1.c2], [t1.c3]), partitions(p0)

select c2, c3, c2 and c3 from t1;
+------+------+-----------+
| c2   | c3   | c2 and c3 |
+------+------+-----------+
|    1 | NULL |      NULL |
+------+------+-----------+
EXPLAIN select c2, c3, c2 or c3 from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([t1.c2], [t1.c3], [t1.c2 OR t1.c3]), filter(nil), 
      access([t1.c2], [t1.c3]), partitions(p0)

select c2, c3, c2 or c3 from t1;
+------+------+----------+
| c2   | c3   | c2 or c3 |
+------+------+----------+
|    1 | NULL |        1 |
+------+------+----------+
EXPLAIN select c3, c1, c3 and c1 from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([t1.c3], [t1.c1], [t1.c3 AND t1.c1]), filter(nil), 
      access([t1.c3], [t1.c1]), partitions(p0)

select c3, c1, c3 and c1 from t1;
+------+------+-----------+
| c3   | c1   | c3 and c1 |
+------+------+-----------+
| NULL |    0 |         0 |
+------+------+-----------+
EXPLAIN select c3, c1, c3 or c1 from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([t1.c3], [t1.c1], [t1.c3 OR t1.c1]), filter(nil), 
      access([t1.c3], [t1.c1]), partitions(p0)

select c3, c1, c3 or c1 from t1;
+------+------+----------+
| c3   | c1   | c3 or c1 |
+------+------+----------+
| NULL |    0 |     NULL |
+------+------+----------+
EXPLAIN select c3, c2, c3 and c2 from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([t1.c3], [t1.c2], [t1.c3 AND t1.c2]), filter(nil), 
      access([t1.c3], [t1.c2]), partitions(p0)

select c3, c2, c3 and c2 from t1;
+------+------+-----------+
| c3   | c2   | c3 and c2 |
+------+------+-----------+
| NULL |    1 |      NULL |
+------+------+-----------+
EXPLAIN select c3, c2, c3 or c2 from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([t1.c3], [t1.c2], [t1.c3 OR t1.c2]), filter(nil), 
      access([t1.c3], [t1.c2]), partitions(p0)

select c3, c2, c3 or c2 from t1;
+------+------+----------+
| c3   | c2   | c3 or c2 |
+------+------+----------+
| NULL |    1 |        1 |
+------+------+----------+
EXPLAIN select c3, c3, c3 and c3 from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([t1.c3], [t1.c3], [t1.c3 AND t1.c3]), filter(nil), 
      access([t1.c3]), partitions(p0)

select c3, c3, c3 and c3 from t1;
+------+------+-----------+
| c3   | c3   | c3 and c3 |
+------+------+-----------+
| NULL | NULL |      NULL |
+------+------+-----------+
EXPLAIN select c3, c3, c3 or c3 from t1;
Query Plan
===================================
|ID|OPERATOR  |NAME|EST. ROWS|COST|
-----------------------------------
|0 |TABLE SCAN|t1  |1        |36  |
===================================

Outputs & filters: 
-------------------------------------
  0 - output([t1.c3], [t1.c3], [t1.c3 OR t1.c3]), filter(nil), 
      access([t1.c3]), partitions(p0)

select c3, c3, c3 or c3 from t1;
+------+------+----------+
| c3   | c3   | c3 or c3 |
+------+------+----------+
| NULL | NULL |     NULL |
+------+------+----------+

drop table t1;
CREATE TABLE t1(c0 VARCHAR(500), c1 DECIMAL);
EXPLAIN insert into t1 values('', 123);
Query Plan
====================================
|ID|OPERATOR   |NAME|EST. ROWS|COST|
------------------------------------
|0 |INSERT     |    |1        |1   |
|1 | EXPRESSION|    |1        |1   |
====================================

Outputs & filters: 
-------------------------------------
  0 - output([column_conv(BIGINT UNSIGNED,PS:(-1,-1),NOT NULL,nextval(1))], [column_conv(VARCHAR,utf8mb4_general_ci,length:500,NULL,__values.c0)], [column_conv(DECIMAL,PS:(10,0),NULL,__values.c1)]), filter(nil), 
      columns([{t1: ({t1: (t1.__pk_increment, t1.c0, t1.c1)})}]), partitions(p0)
  1 - output([__values.c0], [__values.c1]), filter(nil)
      values({'', 123})

insert into t1 values('', 123);
EXPLAIN SELECT ALL t1.c0 AS ref0 FROM t1 WHERE (NULL AND ( CAST(COALESCE(t1.c0,  EXISTS (SELECT 1)) AS SIGNED) IS NOT NULL)) IS NULL;
Query Plan
=======================================
|ID|OPERATOR      |NAME|EST. ROWS|COST|
---------------------------------------
|0 |SUBPLAN FILTER|    |1        |37  |
|1 | TABLE SCAN   |t1  |1        |37  |
|2 | LIMIT        |    |1        |1   |
|3 |  EXPRESSION  |    |1        |1   |
=======================================

Outputs & filters: 
-------------------------------------
  0 - output([t1.c0]), filter(nil), 
      exec_params_(nil), onetime_exprs_([cast((T_OP_EXISTS, subquery(1)), VARCHAR(500))]), init_plan_idxs_(nil)
  1 - output([t1.c0]), filter([(T_OP_IS, ? AND (T_OP_IS_NOT, cast(coalesce(t1.c0, ?), BIGINT(0, 0)), NULL, 0), NULL, 0)]), 
      access([t1.c0]), partitions(p0)
  2 - output([1]), filter(nil), limit(1), offset(nil)
  3 - output([1]), filter(nil)
      values({1})

SELECT ALL t1.c0 AS ref0 FROM t1 WHERE (NULL AND ( CAST(COALESCE(t1.c0,  EXISTS (SELECT 1)) AS SIGNED) IS NOT NULL)) IS NULL;
+------+
| ref0 |
+------+
|      |
+------+
Warnings:
Warning	1292	Truncated incorrect INTEGER value: ''
drop table t1;
